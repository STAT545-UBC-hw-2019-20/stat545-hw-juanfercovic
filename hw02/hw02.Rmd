---
title: "hw02"
author: "JMF"
date: "27/09/2019"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(gapminder)
library(tidyverse)
library(dplyr)
library(magrittr)
library(qwraps2)
library(ggplot2)
options(qwraps2_markup = 'markdown') # default is late
args(summary_table)
```

## 1.1 and 1.2
Use filter() to subset the gapminder data to three countries of your choice in the 1970’s.
Use the pipe operator %>% to select “country” and “gdpPercap” from your filtered dataset in 1.1.
```{r , echo = TRUE}
subset <- filter(gapminder, country %in% 
                   c("Canada", "Mexico", "United States"), 
                 year > 1969,  year < 1981)
subset %>% select(country,gdpPercap)
```
## 1.3 
Filter gapminder to all entries that have experienced a drop in life expectancy. Be sure to include a new variable that’s the increase in life expectancy in your tibble. Hint: you might find the lag() or diff() functions useful.

```{r , echo = TRUE}
le_drop <- select(gapminder, country, year, continent, lifeExp) %>%
  group_by(country) %>%
  mutate(le_delta = lifeExp - lag(lifeExp))
  
  filter(le_drop, le_delta<0)
```

## 1.4a 
Max GDP per capita experienced by each country.
Filter gapminder so that it shows the max GDP per capita experienced by each country.
```{r , echo = TRUE}
  gapminder %>%
  select(country, year, continent, gdpPercap) %>%
  arrange(country) %>%
  group_by(country) %>%
  top_n(1, wt = desc(gdpPercap)) ## gets the max

```

## 1.5 
Scatterplot of Canada’s life expectancy vs. GDP per capita using ggplot2

```{r , echo = FALSE}
filter(gapminder, country %in% c("Canada")) %>%
ggplot(aes(x=log(gdpPercap),y=lifeExp)) + geom_point() 
```

## 2 
Explore individual variables with dplyr

```{r gapminder, echo = FALSE}
#summary table for Life Exp.

summary_lifeexp <-
  list("Life Expentancy" =
         list("min" = ~ min(gapminder$lifeExp),
              "max" = ~ max(gapminder$lifeExp),
              "mean" = ~ mean(gapminder$lifeExp),
              "sd" = ~ sd(gapminder$lifeExp)),
       "Years" = 
         list("min" = ~ min(gapminder$year),
              "max" = ~ max(gapminder$year)
              ))


summary_table(gapminder, summary_lifeexp)

```

## 2a

Grouped by Continent
```{r , echo = FALSE}

summary_table(dplyr::group_by(gapminder, continent), summary_lifeexp)

```

## test
```{r , echo = FALSE}
mtcar_summaries <-
  list("Miles Per Gallon" =
         list("min:"         = ~ min(mpg),
              "mean (sd)"    = ~ qwraps2::mean_sd(mpg, denote_sd = "paren"),
              "median (IQR)" = ~ qwraps2::median_iqr(mpg),
              "max:"         = ~ max(mpg)),
       "Cylinders:" = 
         list("mean"             = ~ mean(cyl),
              "mean (formatted)" = ~ qwraps2::frmt(mean(cyl)),
              "4 cyl, n (%)"     = ~ qwraps2::n_perc0(cyl == 4),
              "6 cyl, n (%)"     = ~ qwraps2::n_perc0(cyl == 6),
              "8 cyl, n (%)"     = ~ qwraps2::n_perc0(cyl == 8)),
       "Weight" =
         list("Range" = ~ paste(range(wt), collapse = ", "))
  )


#The table is constructed and printed with ease:
  
  summary_table(mtcars, mtcar_summaries)

```
## Slide with Plot

```{r pressure}
plot(pressure)
```

