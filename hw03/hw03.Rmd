---
title: 'STAT 545A Assignment 03: dplyr/ggplot2 Part II'
output:
  pdf_document: default
  html_document: default
---
```{r, warning = FALSE, message = FALSE}
library(tidyverse)
library(ggplot2)
library(gapminder)
knitr::opts_chunk$set(echo = TRUE)
```

# Instructions
Pick three of the six tasks below, and produce:

- a tibble, using dplyr as your data manipulation tool;
- an accompanying plot of data from the tibble, using ggplot2 as your visualization tool; and
- some dialogue about what your tables/figures show (doesn’t have to be much).


# Task Option 1
Report the absolute and/or relative abundance of countries with low life expectancy over time by continent: Compute some measure of worldwide life expectancy – you decide – a mean or median or some other quantile or perhaps your current age. Then determine how many countries on each continent have a life expectancy less than this benchmark, for each year.

```{r, echo = TRUE}
gapminder %>%
  select(country, year, continent, lifeExp) %>%
  summarise(LE = mean(lifeExp),
            low = quantile(lifeExp,0.25)) -> threshold

gapminder %>%
  select(country, year, continent, lifeExp) %>%
  group_by(continent, year) %>%
  summarise(n_total = n()) %>%
  filter(lifeExp < low) %>%
  summarise(n_low = n()) #%>%
```





```{r, echo = TRUE}
gapminder %>%
  select(country, year, continent, lifeExp) %>%
  mutate(n_low = ifelse(lifeExp < quantile(lifeExp,0.25), n(),NA)) %>%
  group_by(continent, year) %>%
  summarise(LE = mean(lifeExp),
            low = quantile(lifeExp,0.25),
            n_total = n(),
            n_low = mean(n_low)) #%>%


```

# Task Option 2
Get the maximum and minimum of GDP per capita for all continents.
```{r, echo = TRUE}

  gapminder %>%
  select(country, year, continent, gdpPercap) %>%
  arrange(country) %>%
  top_n(5, wt = desc(gdpPercap)) ## gets the max
```

# Task Option 3
Look at the spread of GDP per capita within the continents.
```{r}

```

# Task Option 4
Compute a trimmed mean of life expectancy for different years. Or a weighted mean, weighting by population. Just try something other than the plain vanilla mean.
```{r}

```

# Task Option 5
How is life expectancy changing over time on different continents?
```{r}
gapminder %>%
    group_by(continent, year) %>%
    summarise(lifeExp=median(lifeExp)) 
```


```{r}
gapminder %>%
    group_by(continent, year) %>%
    summarise(lifeExp=median(lifeExp)) %>%
    ggplot(aes(x=year, y=lifeExp, color=continent)) +
     geom_line(size=1) + 
     geom_point(size=1.5)
```


```{r}
ggplot(gapminder, 
       aes(year,lifeExp, colour = continent)) + 
  geom_smooth() + ggtitle("Life Expextancy over Time by Continent") +
  xlab("Year") + ylab("Avg. Life Expectancy") 
```

# Task Option 6
Find countries with interesting stories. Open-ended and, therefore, hard. Promising but unsuccessful attempts are encouraged. This will generate interesting questions to follow up on in class.
```{r}

```


